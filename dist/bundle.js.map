{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js"],"names":["document","addEventListener","width","height","maxRadius","Math","min","formatNumber","d3","format","x","scaleLinear","range","PI","clamp","y","scaleSqrt","color","scaleOrdinal","schemeCategory10","partition","arc","startAngle","d","x0","endAngle","x1","innerRadius","max","y0","outerRadius","y1","middleArcLine","halfPi","angles","r","middleAngle","invertDirection","reverse","path","toString","textFits","CHAR_SPACE","deltaAngle","perimeter","data","name","length","svg","select","append","style","attr","on","focusOn","json","then","root","hierarchy","sum","size","slice","selectAll","descendants","exit","remove","newSlice","enter","event","stopPropagation","text","value","children","parent","_","i","transition","duration","tween","xd","interpolate","domain","yd","t","attrTween","moveStackToFront"],"mappings":"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","file":"./bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","document.addEventListener(\"DOMContentLoaded\", () => {\r\n    const width = 900,\r\n        height = 600,\r\n        maxRadius = (Math.min(width, height) / 2) - 5;\r\n\r\n    const formatNumber = d3.format(',d');\r\n\r\n    const x = d3.scaleLinear()\r\n        .range([0, 2 * Math.PI])\r\n        .clamp(true);\r\n\r\n    const y = d3.scaleSqrt()\r\n        .range([maxRadius*.1, maxRadius]);\r\n\r\n    const color = d3.scaleOrdinal(d3.schemeCategory10)\r\n\r\n    const partition = d3.partition();\r\n\r\n    const arc = d3.arc()\r\n        .startAngle(d => x(d.x0))\r\n        .endAngle(d => x(d.x1))\r\n        .innerRadius(d => Math.max(0, y(d.y0)))\r\n        .outerRadius(d => Math.max(0, y(d.y1)));\r\n\r\n    const middleArcLine = d => {\r\n        const halfPi = Math.PI/2;\r\n        const angles = [x(d.x0) - halfPi, x(d.x1) - halfPi];\r\n        const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);\r\n\r\n        const middleAngle = (angles[1] + angles[0]) / 2;\r\n        const invertDirection = middleAngle > 0 && middleAngle < Math.PI; \r\n        if (invertDirection) { angles.reverse(); }\r\n\r\n        const path = d3.path();\r\n        path.arc(0, 0, r, angles[0], angles[1], invertDirection);\r\n        return path.toString();\r\n    };\r\n\r\n    const textFits = d => {\r\n        const CHAR_SPACE = 6;\r\n\r\n        const deltaAngle = x(d.x1) - x(d.x0);\r\n        const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);\r\n        const perimeter = r * deltaAngle;\r\n\r\n        if (d.data.name) {\r\n            return d.data.name.length * CHAR_SPACE < perimeter;\r\n        }\r\n    };\r\n\r\n    const svg = d3.select('body').append('svg')\r\n        .style('width', '1500')\r\n        .style('height', '900')\r\n        .attr('viewBox', `${-width / 2} ${-height / 2} ${width} ${height}`)\r\n        .on('click', () => focusOn()); \r\n\r\n    d3.json(\"/src/game.json\").then((root) => {\r\n\r\n        root = d3.hierarchy(root);\r\n        root.sum(d => d.size);\r\n\r\n        const slice = svg.selectAll('g.slice')\r\n            .data(partition(root).descendants());\r\n\r\n        slice.exit().remove();\r\n\r\n        const newSlice = slice.enter()\r\n            .append('g')\r\n            .attr('class', 'slice')\r\n            .on('click', d => {\r\n                d3.event.stopPropagation();\r\n                focusOn(d);\r\n            });\r\n\r\n        newSlice.append('title')\r\n            .text(d => d.data.name + '\\n' + formatNumber(d.value));\r\n\r\n        newSlice.append('path')\r\n            .attr('class', 'main-arc')\r\n            .style('fill', d => color((d.children ? d : d.parent).data.name))\r\n            .attr('d', arc);\r\n\r\n        newSlice.append('path')\r\n            .attr('class', 'hidden-arc')\r\n            .attr('id', (_, i) => `hiddenArc${i}`)\r\n            .attr('d', middleArcLine);\r\n\r\n        const text = newSlice.append('text')\r\n            .attr('display', d => textFits(d) ? d.data : 'none');\r\n            \r\n        text.append('textPath')\r\n            .attr('startOffset','50%')\r\n            .attr('xlink:href', (_, i) => `#hiddenArc${i}` )\r\n            .text(d => d.data.name)\r\n            .style('fill', 'none')\r\n            .style('stroke', '#fff')\r\n            .style('stroke-width', 5)\r\n            .style('stroke-linejoin', 'round');\r\n\r\n        text.append('textPath')\r\n            .attr('startOffset','50%')\r\n            .attr('xlink:href', (_, i) => `#hiddenArc${i}` )\r\n            .text(d => d.data.name);\r\n    });\r\n\r\n    function focusOn(d = { x0: 0, x1: 1, y0: 0, y1: 1 }) {\r\n        const transition = svg.transition()\r\n            .duration(750)\r\n            .tween('scale', () => {\r\n                const xd = d3.interpolate(x.domain(), [d.x0, d.x1]),\r\n                    yd = d3.interpolate(y.domain(), [d.y0, 1]);\r\n                return t => { x.domain(xd(t)); y.domain(yd(t)); };\r\n            });\r\n\r\n        transition.selectAll('path.main-arc')\r\n            .attrTween('d', d => () => arc(d));\r\n\r\n        transition.selectAll('path.hidden-arc')\r\n            .attrTween('d', d => () => middleArcLine(d));\r\n\r\n        transition.selectAll('text')\r\n            .attrTween('display', d => textFits(d) ? null : 'none');\r\n\r\n        moveStackToFront();\r\n\r\n        function moveStackToFront() {\r\n            svg.selectAll('.slice')\r\n        }\r\n    }\r\n})\r\n"],"sourceRoot":""}